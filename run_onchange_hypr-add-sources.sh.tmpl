#!/bin/bash
set -euo pipefail

CONF="$HOME/.config/hypr/hyprland.conf"
SOURCES=(
    "source = ~/.config/hypr/overrides.conf"
{{ if eq .machine_type "mac" -}}
    "source = ~/.config/hypr/mac-overrides.conf"
{{- end }}
)

if [[ ! -f "$CONF" ]]; then
  echo "Hyprland config not found at $CONF, skipping source injection."
  exit 0
fi

for src in "${SOURCES[@]}"; do
    if ! grep -qF "$src" "$CONF"; then
        echo "$src" >> "$CONF"
    fi
done

echo "âœ“ Hyprland sources ensured in $CONF"
